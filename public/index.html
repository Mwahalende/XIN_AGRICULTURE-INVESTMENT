<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>XIN Agricultural Investment</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
  <link rel="stylesheet" href="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
  <script src="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js"></script>
  <style>
    :root {
      --primary: #28a745;
      --secondary: #007bff;
      --danger: #dc3545;
      --warning: #ffc107;
      --info: #17a2b8;
      --light: #f8f9fa;
      --dark: #343a40;
      --success: #28a745;
      --white: #ffffff;
      --gray-100: #f8f9fa;
      --gray-200: #e9ecef;
      --gray-300: #dee2e6;
      --gray-800: #495057;
      --shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
      --shadow-lg: 0 1rem 3rem rgba(0, 0, 0, 0.175);
      --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    [data-theme='dark'] {
      --bg: #121212;
      --text: #f0f0f0;
      --card-bg: #1e1e1e;
      --modal-bg: #2a2a2a;
      --primary: #4caf50;
      --btn-text: #ffffff;
      --input-bg: #333;
      --shadow: rgba(255, 255, 255, 0.05);
      --input-border: #555;
      --link-color: var(--primary);
      --dark: #f0f0f0;
      --gray-800: #ccc;
      --gray-300: #555;
      --gray-100: #333;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.5));
      min-height: 100vh;
      color: var(--dark);
      position: relative;
      overflow-x: hidden;
    }

    /* Animated Background Images */
    .background-slider {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .background-slide {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      opacity: 0;
      transition: opacity 2.5s ease-in-out;
    }

    .background-slide.active {
      opacity: 1;
    }

    .background-slide:nth-child(1) {
      background-image: url('https://images.unsplash.com/photo-1574943320219-553eb213f72d?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80');
    }

    .background-slide:nth-child(2) {
      background-image: url('https://images.unsplash.com/photo-1587671267313-70394e676301?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80');
    }

    .background-slide:nth-child(3) {
      background-image: url('https://images.unsplash.com/photo-1581833971358-2c8b550f87b3?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80');
    }

    .background-slide:nth-child(4) {
      background-image: url('https://images.unsplash.com/photo-1530836369250-ef72a3f5cda8?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80');
    }

    .background-slide:nth-child(5) {
      background-image: url('https://images.unsplash.com/photo-1523348837708-15d4a09cfac2?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80');
    }

    .navbar {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      padding: 1rem 2rem;
      box-shadow: var(--shadow-lg);
      position: sticky;
      top: 0;
      z-index: 100;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    .navbar-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-size: 1.8rem;
      font-weight: bold;
      color: var(--primary);
      text-decoration: none;
    }

    .nav-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .theme-toggle {
      background: var(--gray-100);
      border: 2px solid var(--gray-300);
      padding: 0.5rem;
      border-radius: 0.5rem;
      cursor: pointer;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .theme-toggle:hover {
      background: var(--primary);
      border-color: var(--primary);
      transform: scale(1.1);
    }

    .btn {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 0.375rem;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      transition: all 0.3s ease;
      font-weight: 500;
      text-align: center;
    }

    .btn-primary {
      background: var(--primary);
      color: var(--white);
    }

    .btn-primary:hover {
      background: #218838;
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .btn-outline {
      background: transparent;
      border: 2px solid var(--primary);
      color: var(--primary);
    }

    .btn-outline:hover {
      background: var(--primary);
      color: var(--white);
    }

    .btn-logout {
      background: rgba(220, 53, 69, 0.9);
      border: 2px solid rgba(220, 53, 69, 1);
      color: var(--white);
      padding: 0.75rem 1.5rem;
      font-weight: 600;
      font-size: 1rem;
      border-radius: 0.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-logout:hover {
      background: #c82333;
      border-color: #c82333;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
    }

    .btn-delete {
      background: rgba(220, 20, 60, 0.9);
      border: 2px solid rgba(220, 20, 60, 1);
      color: var(--white);
      padding: 0.75rem 1.5rem;
      font-weight: 600;
      font-size: 0.9rem;
      border-radius: 0.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-delete:hover {
      background: #b91c3c;
      border-color: #b91c3c;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(220, 20, 60, 0.3);
    }

    .hero-section {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      padding: 3rem 2rem;
      text-align: center;
      margin-bottom: 2rem;
      box-shadow: var(--shadow-lg);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .hero-content h1 {
      color: var(--primary);
      font-size: 2.5rem;
      margin-bottom: 1rem;
      font-weight: 700;
    }

    .hero-content p {
      color: var(--gray-800);
      font-size: 1.2rem;
      margin-bottom: 2rem;
    }

    .user-panel {
      background: rgba(40, 167, 69, 0.9);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      color: var(--white);
      padding: 1.5rem 2rem;
      border-radius: 1rem;
      display: none;
      align-items: center;
      gap: 1.5rem;
      margin: 1rem 0;
      box-shadow: var(--shadow-lg);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .user-avatar {
      width: 50px;
      height: 50px;
      background: var(--white);
      color: var(--primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 1.2rem;
    }

    .user-info {
      flex: 1;
    }

    .user-name {
      font-weight: bold;
      font-size: 1.1rem;
    }

    .user-email {
      opacity: 0.9;
      font-size: 0.9rem;
    }

    .filter-container {
      max-width: 800px;
      margin: 2rem auto;
      padding: 0 2rem;
    }

    .search-box {
      width: 100%;
      padding: 1rem 1.5rem;
      border: 3px solid rgba(255, 255, 255, 0.8);
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 2rem;
      font-size: 1.1rem;
      box-shadow: var(--shadow-lg);
      transition: all 0.3s ease;
    }

    .search-box:focus {
      outline: none;
      border-color: var(--primary);
      transform: scale(1.02);
    }

    .products-section {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem 4rem;
    }

    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 2rem;
    }

    .product-card {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 1rem;
      overflow: hidden;
      box-shadow: var(--shadow-lg);
      transition: all 0.3s ease;
      position: relative;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .product-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 2rem 4rem rgba(0, 0, 0, 0.15);
    }

    .product-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--gradient);
    }

    .product-card img,
    .product-card video {
      width: 100%;
      height: 250px;
      object-fit: cover;
    }

    .product-info {
      padding: 1.5rem;
    }

    .product-name {
      font-size: 1.3rem;
      font-weight: bold;
      color: var(--dark);
      margin-bottom: 0.5rem;
    }

    .product-price {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--primary);
      margin-bottom: 1rem;
    }

    .product-description {
      color: var(--gray-800);
      margin-bottom: 1.5rem;
      line-height: 1.5;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 1000;
      backdrop-filter: blur(5px);
    }

    .modal-content {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      margin: 5% auto;
      padding: 2rem;
      border-radius: 1rem;
      width: 90%;
      max-width: 500px;
      position: relative;
      animation: modalSlideIn 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: var(--shadow-lg);
    }

    [data-theme='dark'] .modal-content {
      background: rgba(30, 30, 30, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    @keyframes modalSlideIn {
      from { transform: translateY(-50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .modal-header h3 {
      color: var(--primary);
      font-size: 1.5rem;
    }

    .close-btn {
      font-size: 2rem;
      cursor: pointer;
      color: var(--gray-800);
      background: none;
      border: none;
      transition: color 0.3s ease;
    }

    .close-btn:hover {
      color: var(--danger);
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: var(--dark);
    }

    .form-input {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid var(--gray-300);
      border-radius: 0.5rem;
      transition: border-color 0.3s ease;
      font-size: 1rem;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--primary);
    }

    .form-input[readonly] {
      background: var(--gray-100);
    }

    .error {
      color: var(--danger);
      font-size: 0.9em;
      margin-top: 0.5rem;
    }

    .success {
      color: var(--success);
      font-size: 0.9em;
      margin-top: 0.5rem;
    }

    .auth-links {
      margin-top: 1rem;
      text-align: center;
    }

    .auth-links a {
      color: var(--primary);
      text-decoration: none;
      margin: 0 0.5rem;
    }

    .auth-links a:hover {
      text-decoration: underline;
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 1rem 1.5rem;
      border-radius: 0.5rem;
      color: var(--white);
      z-index: 1001;
      animation: slideIn 0.3s ease;
    }

    .notification.success {
      background: var(--success);
    }

    .notification.error {
      background: var(--danger);
    }

    @keyframes slideIn {
      from { transform: translateX(100%); }
      to { transform: translateX(0); }
    }

    @media (max-width: 768px) {
      .navbar-content {
        flex-direction: column;
        gap: 1rem;
      }

      .hero-content h1 {
        font-size: 2rem;
      }

      .user-panel {
        flex-direction: column;
        text-align: center;
        gap: 1rem;
        padding: 1rem;
      }

      .user-info {
        margin: 0;
      }

      .user-panel > div:last-child {
        width: 100%;
      }

      .user-panel .btn {
        width: 100%;
        justify-content: center;
      }

      .products-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }

      .modal-content {
        margin: 10% auto;
        width: 95%;
      }

      .footer-content {
        flex-direction: column;
        text-align: center;
        gap: 2rem;
      }

      .footer-section {
        flex: none;
      }

      .footer-bottom {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
      }
    }

    /* Footer Styles */
    .footer {
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      color: var(--white);
      margin-top: 4rem;
      padding: 3rem 0 1rem;
      position: relative;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #28a745, #007bff, #17a2b8, #ffc107);
    }

    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem;
      display: flex;
      gap: 3rem;
      flex-wrap: wrap;
    }

    .footer-section {
      flex: 1;
      min-width: 300px;
    }

    .footer-section h3 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .footer-section p, .footer-section li {
      line-height: 1.7;
      margin-bottom: 0.5rem;
      opacity: 0.9;
    }

    .footer-section ul {
      list-style: none;
      padding: 0;
    }

    .footer-section ul li {
      padding: 0.25rem 0;
    }

    .footer-section ul li::before {
      content: 'üå±';
      margin-right: 0.5rem;
    }

    .developer-info {
      background: rgba(255, 255, 255, 0.1);
      padding: 1.5rem;
      border-radius: 1rem;
      margin-top: 1rem;
      backdrop-filter: blur(5px);
      -webkit-backdrop-filter: blur(5px);
    }

    .developer-info h4 {
      margin-bottom: 0.5rem;
      color: #ffc107;
    }

    .footer-bottom {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem 2rem 1rem;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .footer-bottom p {
      margin: 0;
      opacity: 0.8;
    }

    .footer-links {
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    .footer-links a {
      color: var(--white);
      text-decoration: none;
      opacity: 0.8;
      transition: opacity 0.3s ease;
    }

    .footer-links a:hover {
      opacity: 1;
      text-decoration: underline;
    }
  </style>
</head>
<body data-theme="light">
  <!-- Animated Background Slider -->
  <div class="background-slider">
    <div class="background-slide active"></div>
    <div class="background-slide"></div>
    <div class="background-slide"></div>
    <div class="background-slide"></div>
    <div class="background-slide"></div>
  </div>

  <nav class="navbar">
    <div class="navbar-content">
      <a href="/index.html" class="logo">üå± XIN Agricultural Investment</a>
      <div class="nav-actions">
        <button class="theme-toggle" onclick="toggleTheme()">üåì</button>
        <a href="/login.html" class="btn btn-outline">login</a>
      </div>
    </div>
  </nav>

  <div class="hero-section">
    <div class="hero-content">
      <h1>Premium Agricultural Products</h1>
      <p>Fresh, quality agricultural products delivered to your doorstep</p>
    </div>

    <div class="user-panel" id="userPanel">
      <div class="user-avatar" id="userAvatar">U</div>
      <div class="user-info">
        <div class="user-name" id="userName">Loading...</div>
        <div class="user-email" id="userEmail">Loading...</div>
      </div>
      <div style="display: flex; flex-direction: column; gap: 0.5rem;">
        <a href="/myorder.html" class="btn btn-primary">üì¶ My Orders</a>
        <button onclick="logout()" class="btn-logout">üö™ Logout</button>
        <button onclick="deleteAccount()" class="btn-delete">üóëÔ∏è Delete Account</button>
      </div>
    </div>
  </div>

  <div class="filter-container">
    <input type="text" id="filterInput" class="search-box" placeholder="üîç Search products by name..." />
  </div>

  <div class="products-section">
    <div id="products" class="products-grid"></div>
  </div>

  <!-- Auth Modal -->
  <div id="authModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="authTitle">Customer Login</h3>
        <button class="close-btn" onclick="closeAuthModal()">&times;</button>
      </div>
      
      <div id="authForms">
        <form id="loginForm">
          <div class="form-group">
            <label class="form-label">Email Address</label>
            <input type="email" name="email" class="form-input" placeholder="Enter your email" required />
          </div>
          <div class="form-group">
            <label class="form-label">Password</label>
            <input type="password" name="password" class="form-input" placeholder="Enter your password" required />
          </div>
          <button type="submit" class="btn btn-primary" style="width: 100%;">Login</button>
          <p class="error" id="loginError"></p>
          <div class="auth-links">
            <a href="#" onclick="showRegisterForm(); return false;">Don't have an account? Register</a>
            <br>
            <a href="#" onclick="showForgotForm(); return false;">Forgot Password?</a>
          </div>
        </form>
        
        <form id="registerForm" style="display:none;">
          <div class="form-group">
            <label class="form-label">Full Name</label>
            <input type="text" name="name" class="form-input" placeholder="Enter your full name" required />
          </div>
          <div class="form-group">
            <label class="form-label">Email Address</label>
            <input type="email" name="email" class="form-input" placeholder="Enter your email" required />
          </div>
          <div class="form-group">
            <label class="form-label">Phone Number</label>
            <input type="text" name="contact" class="form-input" placeholder="07xxxxxxx or +2557xxxxxxx" required />
          </div>
          <div class="form-group">
            <label class="form-label">Password</label>
            <input type="password" name="password" class="form-input" placeholder="At least 8 characters" required />
          </div>
          <button type="submit" class="btn btn-primary" style="width: 100%;">Register</button>
          <p class="error" id="registerError"></p>
          <div class="auth-links">
            <a href="#" onclick="showLoginForm(); return false;">Already have an account? Login</a>
            <br>
            <a href="#" onclick="showForgotForm(); return false;">Forgot Password?</a>
          </div>
        </form>
        
        <form id="forgotForm" style="display:none;">
          <div class="form-group">
            <label class="form-label">Email Address</label>
            <input type="email" name="email" class="form-input" placeholder="Enter your registered email" required />
          </div>
          <button type="submit" class="btn btn-primary" style="width: 100%;">Reset Password</button>
          <p class="error" id="forgotError"></p>
          <div class="auth-links">
            <a href="#" onclick="showLoginForm(); return false;">Back to Login</a>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Order Modal -->
  <div id="orderModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Place Order</h3>
        <button class="close-btn" onclick="closeOrderModal()">&times;</button>
      </div>
      <form id="orderForm">
        <div class="form-group">
          <label class="form-label">Product</label>
          <input type="text" id="orderProduct" class="form-input" readonly />
        </div>
        <div class="form-group">
          <label class="form-label">Quantity</label>
          <input type="number" id="orderQty" class="form-input" min="1" value="1" required placeholder="Enter quantity" />
        </div>
        <div class="form-group">
          <label class="form-label">Total Amount</label>
          <input type="text" id="orderTotal" class="form-input" readonly style="font-weight: bold; color: var(--primary);" />
        </div>
        <button type="submit" class="btn btn-primary" style="width: 100%;">Complete Order</button>
      </form>
    </div>
  </div>

  <!-- Delete Account Confirmation Modal -->
  <div id="deleteModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 style="color: var(--danger);">‚ö†Ô∏è Delete Account</h3>
        <button class="close-btn" onclick="closeDeleteModal()">&times;</button>
      </div>
      <div style="margin-bottom: 1.5rem;">
        <p style="margin-bottom: 1rem; color: var(--gray-800);">
          <strong>Are you sure you want to delete your account?</strong>
        </p>
        <p style="margin-bottom: 1rem; color: var(--gray-800);">
          This action is <strong>permanent</strong> and cannot be undone. All your data including:
        </p>
        <ul style="margin: 1rem 0; padding-left: 2rem; color: var(--gray-800);">
          <li>Your order history</li>
          <li>Personal information</li>
          <li>Account preferences</li>
        </ul>
        <p style="color: var(--danger); font-weight: 600;">
          Will be permanently deleted from our system.
        </p>
      </div>
      
      <div class="form-group">
        <label class="form-label">Type "DELETE" to confirm:</label>
        <input type="text" id="deleteConfirmInput" class="form-input" placeholder="Type DELETE in capital letters" />
        <p class="error" id="deleteError"></p>
      </div>
      
      <div style="display: flex; gap: 1rem; justify-content: flex-end;">
        <button class="btn btn-outline" onclick="closeDeleteModal()">Cancel</button>
        <button class="btn btn-delete" onclick="confirmDeleteAccount()" style="background: var(--danger);">
          üóëÔ∏è Delete My Account
        </button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <div class="footer-section">
        <h3>üåæ About XIN Agricultural Investment</h3>
        <p>
          XIN Agricultural Investment is a Tanzanian company specializing in the buying, selling, and distribution of all types of agricultural products. We work directly with farmers across Tanzania to source high-quality produce ‚Äî including fruits, vegetables, grains, seeds, and other farm products ‚Äî and make them easily accessible to consumers, retailers, and wholesalers.
        </p>
        <p>
          Our services cover the entire agricultural value chain ‚Äî from sourcing and packaging to logistics and delivery ‚Äî ensuring fresh, affordable, and reliable supply for every customer. At XIN, we are committed to promoting local agriculture, empowering farmers, and driving food security and economic growth across the country.
        </p>
        <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(255, 255, 255, 0.1); border-radius: 0.5rem;">
          <p style="margin-bottom: 0.5rem;"><strong>üìß Email:</strong> lwingageazi@gmail.com</p>
          <p style="margin-bottom: 0.5rem;"><strong>üìû Phone:</strong> +255 741 131 500 (WhatsApp Available)</p>
          <p><strong>üìç Office Location:</strong> Isesa Primary School, Sumbawanga, Tanzania</p>
        </div>
      </div>

      <div class="footer-section">
        <h3>üó∫Ô∏è Our Location</h3>
        <div style="position: relative; margin-bottom: 1rem;">
          <div id="map" style="width: 100%; height: 300px; border-radius: 0.5rem; overflow: hidden;"></div>
          <div style="position: absolute; top: 10px; right: 10px; z-index: 1000;">
            <button onclick="openGoogleMaps()" style="background: #4285f4; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">
              üåç View in Google Maps
            </button>
          </div>
        </div>
        
        <h3>üéØ Our Services</h3>
        <ul>
          <li>Direct sourcing from local farmers</li>
          <li>Quality control and packaging</li>
          <li>Distribution and logistics</li>
          <li>Wholesale and retail supply</li>
          <li>Agricultural consulting</li>
          <li>Farmer support programs</li>
        </ul>

        <div class="developer-info">
          <h4>üë®‚Äçüíª Developer Info</h4>
          <p><strong>Leo Tito Mwahalende</strong></p>
          <p>Full-Stack Developer | Electronics & Communication Engineer</p>
          <p>üìç Dar es Salaam, Tanzania</p>
          <p>üéì BSc in Electronics Science and Communication (UDSM, 2022‚Äì2025)</p>
          <p>üìß leomwahalende@gmail.com | ‚òéÔ∏è +255 686 962 149</p>
          <p>üîó LinkedIn | GitHub</p>
          <p>Developer of this platform, passionate about tech solutions that empower local industries and improve access through innovation.</p>
        </div>
      </div>
    </div>

    <div class="footer-bottom">
      <p>&copy; 2025 XIN Agricultural Investment. All rights reserved. | Built with ‚ù§Ô∏è in Tanzania</p>
      <div class="footer-links">
        <a href="/index.html">Home</a>
        <a href="/login.html">Login</a>
        <a href="/myorder.html">My Orders</a>
      </div>
    </div>
  </footer>

  <script>
    let products = [];
    let filteredProducts = [];
    let loggedInUser = null;
    let currentProduct = null;

    // Check if user is already logged in
    function checkLoginStatus() {
      const user = localStorage.getItem('currentUser');
      if (user) {
        loggedInUser = JSON.parse(user);
        showUserPanel();
      }
    }

    // Show user panel when logged in
    function showUserPanel() {
      if (loggedInUser) {
        document.getElementById('userPanel').style.display = 'flex';
        document.getElementById('userName').textContent = loggedInUser.name;
        document.getElementById('userEmail').textContent = loggedInUser.email;
        document.getElementById('userAvatar').textContent = loggedInUser.name.charAt(0).toUpperCase();
      }
    }

    // Logout function
    function logout() {
      if (confirm('Are you sure you want to logout?')) {
        localStorage.removeItem('currentUser');
        loggedInUser = null;
        document.getElementById('userPanel').style.display = 'none';
        showNotification('Successfully logged out! üëã', 'success');
      }
    }

    // Delete account functions
    function deleteAccount() {
      document.getElementById('deleteModal').style.display = 'block';
      document.getElementById('deleteConfirmInput').value = '';
      document.getElementById('deleteError').textContent = '';
    }

    function closeDeleteModal() {
      document.getElementById('deleteModal').style.display = 'none';
      document.getElementById('deleteConfirmInput').value = '';
      document.getElementById('deleteError').textContent = '';
    }

    async function confirmDeleteAccount() {
      const confirmInput = document.getElementById('deleteConfirmInput').value;
      const errorEl = document.getElementById('deleteError');
      
      // Validate confirmation input
      if (confirmInput !== 'DELETE') {
        errorEl.textContent = 'Please type "DELETE" exactly as shown to confirm.';
        return;
      }
      
      if (!loggedInUser) {
        errorEl.textContent = 'User session expired. Please refresh the page.';
        return;
      }

      try {
        const res = await fetch('/delete-account', {
          method: 'DELETE',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ 
            email: loggedInUser.email,
            userId: loggedInUser._id || loggedInUser.id
          })
        });
        
        const result = await res.json();
        
        if (result.success) {
          showNotification('Account deleted successfully. You will be redirected shortly.', 'success');
          
          // Clear user data and redirect after a short delay
          setTimeout(() => {
            localStorage.removeItem('currentUser');
            loggedInUser = null;
            document.getElementById('userPanel').style.display = 'none';
            closeDeleteModal();
            showNotification('Thank you for using XIN Agricultural Investment. Goodbye! üëã', 'success');
          }, 2000);
          
        } else {
          errorEl.textContent = result.message || 'Failed to delete account. Please try again.';
        }
      } catch (error) {
        console.error('Delete account error:', error);
        errorEl.textContent = 'Failed to delete account. Please check your connection and try again.';
      }
    }

    function toggleTheme() {
      const body = document.body;
      const current = body.getAttribute("data-theme");
      const newTheme = current === "dark" ? "light" : "dark";
      body.setAttribute("data-theme", newTheme);
      localStorage.setItem('theme', newTheme);
    }

    async function loadProducts() {
      try {
        const res = await fetch('/products');
        products = await res.json();
        filteredProducts = products;
        displayProducts(products);
      } catch (error) {
        console.error('Error loading products:', error);
        showNotification('Failed to load products. Please refresh the page.', 'error');
      }
    }

    function displayProducts(items) {
      const container = document.getElementById('products');
      if (items.length === 0) {
        container.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--gray-800);">No products found.</div>';
        return;
      }
      
      container.innerHTML = items.map(p => `
        <div class="product-card">
          ${p.url.endsWith('.mp4') 
            ? `<video src="${p.url}" controls></video>` 
            : `<img src="${p.url}" alt="${p.name}" />`}
          <div class="product-info">
            <h3 class="product-name">${p.name}</h3>
            <div class="product-price">Tsh ${p.amount.toLocaleString()}</div>
            <p class="product-description">${p.description}</p>
            <button class="btn btn-primary" onclick="placeOrder('${p._id}')" style="width: 100%;">
              üõí Order Now
            </button>
          </div>
        </div>`).join('');
    }

    function showRegisterForm() {
      document.getElementById('loginForm').style.display = 'none';
      document.getElementById('registerForm').style.display = 'block';
      document.getElementById('forgotForm').style.display = 'none';
      document.getElementById('authTitle').textContent = 'Customer Registration';
    }

    function showLoginForm() {
      document.getElementById('registerForm').style.display = 'none';
      document.getElementById('loginForm').style.display = 'block';
      document.getElementById('forgotForm').style.display = 'none';
      document.getElementById('authTitle').textContent = 'Customer Login';
    }

    function showForgotForm() {
      document.getElementById('loginForm').style.display = 'none';
      document.getElementById('registerForm').style.display = 'none';
      document.getElementById('forgotForm').style.display = 'block';
      document.getElementById('authTitle').textContent = 'Reset Password';
    }

    function closeAuthModal() {
      document.getElementById('authModal').style.display = 'none';
      clearErrors();
    }

    function clearErrors() {
      document.getElementById('loginError').textContent = '';
      document.getElementById('registerError').textContent = '';
      document.getElementById('forgotError').textContent = '';
    }

    function closeOrderModal() {
      document.getElementById('orderModal').style.display = 'none';
    }

    function placeOrder(id) {
      if (!loggedInUser) {
        document.getElementById('authModal').style.display = 'block';
        showLoginForm();
        currentProduct = id;
        return;
      }
      
      const prod = products.find(p => p._id === id);
      currentProduct = prod;
      document.getElementById('orderProduct').value = prod.name;
      document.getElementById('orderQty').value = 1;
      document.getElementById('orderTotal').value = `Tsh ${prod.amount.toLocaleString()}`;
      
      // Add event listener for real-time calculation
      const qtyInput = document.getElementById('orderQty');
      qtyInput.removeEventListener('input', calculateTotal);
      qtyInput.addEventListener('input', calculateTotal);
      
      document.getElementById('orderModal').style.display = 'block';
    }

    // Function to calculate total in real-time
    function calculateTotal() {
      const quantity = parseInt(document.getElementById('orderQty').value) || 0;
      if (currentProduct && quantity > 0) {
        const total = currentProduct.amount * quantity;
        document.getElementById('orderTotal').value = `Tsh ${total.toLocaleString()}`;
      } else {
        document.getElementById('orderTotal').value = 'Tsh 0';
      }
    }

    // Show notification
    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.textContent = message;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.remove();
      }, 4000);
    }

    document.addEventListener('DOMContentLoaded', () => {
      // Load saved theme
      const savedTheme = localStorage.getItem('theme') || 'light';
      document.body.setAttribute('data-theme', savedTheme);
      
      checkLoginStatus();
      loadProducts();
      
      // Filter products
      document.getElementById('filterInput').addEventListener('input', function () {
        const q = this.value.toLowerCase();
        const filtered = products.filter(p => p.name.toLowerCase().includes(q));
        displayProducts(filtered);
      });

      // Login form handler
      document.getElementById('loginForm').onsubmit = async e => {
        e.preventDefault();
        const form = e.target;
        const formData = {
          email: form.email.value.trim(),
          password: form.password.value
        };

        try {
          const res = await fetch('/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
          });
          
          const result = await res.json();
          if (result.success) {
            loggedInUser = result.user;
            localStorage.setItem('currentUser', JSON.stringify(result.user));
            showUserPanel();
            closeAuthModal();
            showNotification('Login successful!', 'success');
            
            if (currentProduct && typeof currentProduct === 'string') {
              placeOrder(currentProduct);
            }
          } else {
            document.getElementById('loginError').textContent = result.message;
          }
        } catch (error) {
          console.error('Login error:', error);
          document.getElementById('loginError').textContent = 'Login failed. Please try again.';
        }
      };

      // Register form handler
      document.getElementById('registerForm').onsubmit = async e => {
        e.preventDefault();
        const form = e.target;
        
        // Validation
        const password = form.password.value;
        if (password.length < 8) {
          document.getElementById('registerError').textContent = 'Password must be at least 8 characters long.';
          return;
        }

        const contact = form.contact.value.trim();
        if (!contact.match(/^(\+?255|0)?(6|7)[0-9]{8}$/)) {
          document.getElementById('registerError').textContent = 'Invalid Tanzania phone number format.';
          return;
        }

        const formData = {
          name: form.name.value.trim(),
          email: form.email.value.trim(),
          contact: contact,
          password: password
        };

        try {
          const res = await fetch('/register', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
          });
          
          const result = await res.json();
          if (result.success) {
            showNotification('Registration successful! Please login.', 'success');
            showLoginForm();
          } else {
            document.getElementById('registerError').textContent = result.message;
          }
        } catch (error) {
          console.error('Registration error:', error);
          document.getElementById('registerError').textContent = 'Registration failed. Please try again.';
        }
      };

      // Forgot password form handler
      document.getElementById('forgotForm').onsubmit = async e => {
        e.preventDefault();
        const form = e.target;
        const email = form.email.value.trim();
        
        try {
          const res = await fetch('/user-forgot-password', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email })
          });
          
          const result = await res.json();
          const errorEl = document.getElementById('forgotError');
          
          if (result.success) {
            errorEl.className = 'success';
            errorEl.textContent = result.message;
            setTimeout(() => {
              showLoginForm();
              errorEl.textContent = '';
              errorEl.className = 'error';
            }, 3000);
          } else {
            errorEl.textContent = result.message;
          }
        } catch (error) {
          console.error('Forgot password error:', error);
          document.getElementById('forgotError').textContent = 'Failed to send reset email. Please try again.';
        }
      };

      // Order form handler
      document.getElementById('orderForm').onsubmit = async e => {
        e.preventDefault();
        const qty = +document.getElementById('orderQty').value;
        
        if (!qty || qty < 1) {
          showNotification('Please enter a valid quantity.', 'error');
          return;
        }
        
        const totalAmount = currentProduct.amount * qty;
        
        try {
          const res = await fetch('/placeorder', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              product: currentProduct.name,
              amount: totalAmount,
              quantity: qty,
              email: loggedInUser.email,
              contact: loggedInUser.contact
            })
          });
          
          const result = await res.json();
          if (result.success) {
            showNotification('Order placed successfully!', 'success');
            closeOrderModal();
          } else {
            showNotification(result.message || 'Failed to place order', 'error');
          }
        } catch (error) {
          console.error('Order error:', error);
          showNotification('Failed to place order. Please try again.', 'error');
        }
      };

      // Close modal when clicking outside
      window.addEventListener('click', (e) => {
        if (e.target.classList.contains('modal')) {
          if (e.target.id === 'deleteModal') {
            closeDeleteModal();
          } else {
            e.target.style.display = 'none';
          }
        }
      });

      // Background Image Slider Animation
      function initBackgroundSlider() {
        const slides = document.querySelectorAll('.background-slide');
        let currentSlide = 0;

        function nextSlide() {
          slides[currentSlide].classList.remove('active');
          currentSlide = (currentSlide + 1) % slides.length;
          slides[currentSlide].classList.add('active');
        }

        // Change background every 7 seconds
        setInterval(nextSlide, 7000);
      }

      // Initialize background slider
      initBackgroundSlider();
      
      // Initialize map
      initMap();
    });

    // Initialize Leaflet map
    function initMap() {
      // Coordinates for Isesa Primary School, Sumbawanga, Tanzania
      const lat = -8.018727985153813;
      const lng = 31.674437838394876;
      
      const map = L.map('map', {
        fullscreenControl: true,
        fullscreenControlOptions: {
          position: 'topleft'
        }
      }).setView([lat, lng], 15);
      
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap contributors'
      }).addTo(map);
      
      // Add marker for XIN Agricultural Investment office at Isesa Primary School
      L.marker([lat, lng]).addTo(map)
        .bindPopup('<b>üå± XIN Agricultural Investment</b><br>Located at Isesa Primary School<br>Near Maronje, Sumbawanga, Tanzania<br>üìû +255 741 131 500<br>üìß lwingageazi@gmail.com')
        .openPopup();
      
      // Add circle overlay around Isesa Primary School area (near Maronje)
      L.circle([lat, lng], {
        color: '#2E7D32',
        fillColor: '#4CAF50',
        fillOpacity: 0.3,
        radius: 200
      }).addTo(map).bindPopup('<b>Service Area</b><br>Isesa Primary School vicinity<br>Near Maronje, Sumbawanga');
      
      // Add a second circle for wider coverage area
      L.circle([lat, lng], {
        color: '#1976D2',
        fillColor: '#2196F3',
        fillOpacity: 0.1,
        radius: 500
      }).addTo(map).bindPopup('<b>Extended Coverage</b><br>Agricultural services available');
    }

    // Open Google Maps with coordinates
    function openGoogleMaps() {
      const lat = -8.018727985153813;
      const lng = 31.674437838394876;
      const url = `https://maps.google.com/?q=${lat},${lng}&z=15`;
      window.open(url, '_blank');
    }
  </script>
</body>
</html>
